#include <stdio.h>
#include <stdlib.h> 
#include <stdint.h>
#include <string.h>
#include <pthread.h>
#include <math.h>
#include <time.h>
#define MODE 256
#include "utility.h"

int main(){
	uint8_t key1[KEY_BYTE] = {0xb4,0x29,0xdb,0xd1,0x14,0xf8,0xb2,0x69,0x7d,0x83,0xab,0xd0,0x38,0x93,0xf9,0x74,0x79,0x62,0x6d,0xf1,0xb3,0xa3,0xd8,0x67,0xa4,0x15,0xe2,0xbb,0xd5,0xa2,0xa6,0x8a};
	uint8_t key2[KEY_BYTE] = {0xb4,0x29,0xdb,0xd1,0x14,0xf8,0xb2,0x69,0x7d,0x83,0xab,0xd0,0x38,0x93,0xf9,0xf4,0x79,0x62,0x6d,0xf1,0xa3,0xa3,0xd8,0x67,0xa4,0x15,0xe3,0xbb,0xd5,0xa2,0xa6,0x0a};
	uint8_t nonce1[NONCE_BYTE] = {0xbf,0x8a,0x51,0xbd,0xb7,0x1d,0xc3,0xc6,0x84,0x43,0xc0,0x18};
	uint8_t nonce2[NONCE_BYTE] = {0xbf,0x8a,0x51,0x3d,0xb7,0x1d,0xc3,0x46,0x84,0x43,0xc0,0x98};
	uint8_t *nsec;
	uint8_t *ad;
	unsigned long long adlen = 0;
	uint8_t m[4] = {0x29, 0x59, 0x4A, 0xD7};
	unsigned long long mlen = 4;
	uint8_t c1[4+8];
	unsigned long long clen;
	crypto_aead_encrypt(c1, &clen, m, 4, ad, 0, nsec, nonce1, key1);
	printreg(c1, clen);
	
	uint8_t c2[4+8];
	crypto_aead_encrypt(c2, &clen, m, 4, ad, 0, nsec, nonce2, key2);
	printreg(c2, clen);
}
