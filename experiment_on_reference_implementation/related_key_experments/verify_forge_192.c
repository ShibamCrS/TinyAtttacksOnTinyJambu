#include <stdio.h>
#include <stdlib.h> 
#include <stdint.h>
#include <string.h>
#include <pthread.h>
#include <math.h>
#include <time.h>
#define MODE 192
#include "utility.h"

int main(){
	uint8_t key1[KEY_BYTE] = {0x9a,0xe1,0x92,0x48,0x8b,0x10,0x2e,0x07,0xab,0x0f,0x2c,0x02,0x9e,0xdb,0x37,0x7d,0x09,0x0e,0xf1,0x9c,0x66,0xf4,0xaa,0xeb};
	uint8_t key2[KEY_BYTE] = {0x9a,0xe1,0x92,0x48,0x8b,0x10,0x2e,0x87,0xab,0x0f,0x2c,0x02,0x8e,0xdb,0x37,0x7d,0x09,0x0e,0xf0,0x9c,0x66,0xf4,0xaa,0x6b};
	uint8_t nonce1[NONCE_BYTE] = {0x19,0xa2,0x49,0x2e,0xdf,0x81,0xab,0x70,0x92,0x36,0x35,0xdc};
	uint8_t nonce2[NONCE_BYTE] = {0x19,0xa2,0x49,0xae,0xdf,0x81,0xab,0xf0,0x92,0x36,0x35,0x5c};
	uint8_t *nsec;
	uint8_t *ad;
	unsigned long long adlen = 0;
	uint8_t m[4] = {0x11,0x12,0x9d,0xa1};
	unsigned long long mlen = 4;
	uint8_t c1[4+8];
	unsigned long long clen;
	crypto_aead_encrypt(c1, &clen, m, 4, ad, 0, nsec, nonce1, key1);
	printreg(c1, clen);
	
	uint8_t c2[4+8];
	crypto_aead_encrypt(c2, &clen, m, 4, ad, 0, nsec, nonce2, key2);
	printreg(c2, clen);
}
